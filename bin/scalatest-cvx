#!/bin/bash

shopt -s nullglob

echo "Creating class dir..."
mkdir $DELITE/scalatest_cvx_tmp
echo "Compiling tests..."
scalac -deprecation -J"-Xmx2g" -d $DELITE/scalatest_cvx_tmp $DELITE/dsls/opticvx/src/ppl/dsl/opticvx/{common,dcp,model,solverir,solvergen,solvers}/{,test/}*.scala \
&& echo "Running tests..." \
&& scala -cp $DELITE/scalatest_cvx_tmp ppl.dsl.opticvx.common.test.IRPolyTestApp \
&& scala -cp $DELITE/scalatest_cvx_tmp ppl.dsl.opticvx.common.test.SignumPolyTestApp \
&& scala -cp $DELITE/scalatest_cvx_tmp ppl.dsl.opticvx.dcp.test.DCPOpsTestApp
echo "Removing class dir..."
rm -rf $DELITE/scalatest_cvx_tmp
echo "Done!"
